(this.webpackJsonpvibe=this.webpackJsonpvibe||[]).push([[0],{118:function(e,t,a){},121:function(e,t,a){},125:function(e,t,a){},126:function(e,t,a){"use strict";a.r(t);var s=a(0),r=a.n(s),n=a(16),i=a.n(n);a(89),a(90),a(91);var o=window.location.hash.substring(1).split("&").reduce((function(e,t){if(t){var a=t.split("=");e[a[0]]=decodeURIComponent(a[1])}return e}),{});const l="".concat("https://accounts.spotify.com/authorize","?client_id=").concat("03448805c58d4c5ba555ea203c8ce771","&redirect_uri=").concat("http://localhost:3000/","&scope=").concat(["playlist-read-private","user-top-read","user-read-recently-played","playlist-modify-private","playlist-modify-public"].join("%20"),"&response_type=token&show_dialog=true");var c=a(12);class p extends r.a.Component{render(){return this.props.isLoggedIn?null:r.a.createElement("div",null,r.a.createElement(c.a,{className:"submit-button",variant:"success",onClick:()=>this.props.handleLogin()},"Login with Spotify"))}}var m=p,h=a(6),d=a(21);a(92);var u=function(){return r.a.createElement("div",{className:"sound-icon disabled"},r.a.createElement("div",{className:"sound-wave"},r.a.createElement("i",{className:"bar"}),r.a.createElement("i",{className:"bar"}),r.a.createElement("i",{className:"bar"}),r.a.createElement("i",{className:"bar"}),r.a.createElement("i",{className:"bar"}),r.a.createElement("i",{className:"bar"}),r.a.createElement("i",{className:"bar"}),r.a.createElement("i",{className:"bar"}),r.a.createElement("i",{className:"bar"}),r.a.createElement("i",{className:"bar"}),r.a.createElement("i",{className:"bar"}),r.a.createElement("i",{className:"bar"}),r.a.createElement("i",{className:"bar"}),r.a.createElement("i",{className:"bar"}),r.a.createElement("i",{className:"bar"}),r.a.createElement("i",{className:"bar"}),r.a.createElement("i",{className:"bar"}),r.a.createElement("i",{className:"bar"}),r.a.createElement("i",{className:"bar"}),r.a.createElement("i",{className:"bar"})))},g=a(9),y=a.n(g);var b=function(e){return e.isLoggedIn?null:r.a.createElement(d.a,null,r.a.createElement(h.a,{className:"d-flex align-items-center flex-column login justify-content-center login"},r.a.createElement(y.a,{duration:2e3},r.a.createElement("header",null," Vibe "),r.a.createElement(u,null),r.a.createElement(y.a,{delay:1e3},r.a.createElement(m,{isLoggedIn:e.isLoggedIn,handleLogin:()=>e.handleLogin()})),r.a.createElement("h4",{className:"mt-5"},"Get insights into your vibe."),r.a.createElement("h6",{className:"mt-5"}," ","Created by"," ",r.a.createElement("a",{href:"https://nicholas-lin.github.io/",target:"_blank",rel:"noopener noreferrer"}," ","Nicholas Lin."," ")," "),r.a.createElement(y.a,{delay:2e3},r.a.createElement("h6",null,"Your information is never stored. Powered by"," ",r.a.createElement("a",{href:"https://developer.spotify.com/documentation/web-api/",target:"_blank ",rel:"noopener noreferrer"}," ","Spotify's API."," ")," "),r.a.createElement("h6",null,"Give this project a"," ",r.a.createElement("span",{role:"img","aria-label":"star emoji"},"\ud83c\udf1f")," ","on",r.a.createElement("a",{href:"https://github.com/Nicholas-Lin/vibe",target:"_blank",rel:"noopener noreferrer"}," ","Github."))))))},f=a(14),E=a.n(f);E.a.defaults.global.defaultFontColor="white",E.a.defaults.global.defaultColor="white",E.a.defaults.scale.gridLines.color="rgb(83,83,83)",E.a.defaults.LineWithLine=E.a.defaults.line,E.a.controllers.LineWithLine=E.a.controllers.line.extend({draw:function(e){if(E.a.controllers.line.prototype.draw.call(this,e),this.chart.tooltip._active&&this.chart.tooltip._active.length){let e=this.chart.tooltip._active[0],t=this.chart.ctx,a=e.tooltipPosition().x,s=this.chart.legend.bottom,r=this.chart.chartArea.bottom;t.save(),t.beginPath(),t.moveTo(a,s),t.lineTo(a,r),t.lineWidth=2,t.strokeStyle="rgb(255, 255, 255, 0.5)",t.stroke(),t.restore()}}});class v extends r.a.Component{constructor(e){super(e),this.chartRef=r.a.createRef()}componentDidMount(){new E.a(this.chartRef.current,{type:"LineWithLine",data:{labels:this.props.data.labels,datasets:this.props.data.datasets.map(e=>({data:e.data,label:e.label,borderColor:e.borderColor,borderWidth:2,fill:e.fill,backgroundColor:e.backgroundColor,pointBackgroundColor:e.borderColor,pointBorderWidth:1,pointBorderColor:"black",pointRadius:5,pointHitRadius:6,pointHoverBackgroundColor:"black",pointHoverBorderColor:e.borderColor}))},options:{maintainAspectRatio:!1,tooltips:{mode:"index",intersect:!1,titleFontColor:"black",bodyFontColor:"black",backgroundColor:"rgba(255, 255, 255, 0.9)",callbacks:{label:function(e,t){var a=t.datasets[e.datasetIndex].label||"";return a&&(a+=": "),a+=Math.round(e.yLabel)}}}}})}render(){return r.a.createElement(h.a,{className:" h-100 d-flex flex-column justify-content-between align-items-center p-0"},r.a.createElement("h3",null,this.props.title),r.a.createElement("p",null,this.props.description),r.a.createElement("div",{className:"line-chart-container"},r.a.createElement("canvas",{ref:this.chartRef})))}}var k=v,w=a(17),C=a.n(w);var T=class{constructor(e){this.token=e}async addItemsToPlaylist(e,t){const a="\thttps://api.spotify.com/v1/playlists/".concat(e,"/tracks"),s={uris:t},r={headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.token)}};await C.a.post(a,s,r)}async createPlaylist(e,t,a,s=!0){const r="https://api.spotify.com/v1/users/".concat(e,"/playlists"),n={name:t,description:a,public:s},i={headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.token)}};return(await C.a.post(r,n,i)).data.id}async getUserID(){return(await C.a.get("https://api.spotify.com/v1/me",{headers:{Authorization:"Bearer ".concat(this.token)}})).data.id}async getUserFavorites(e,t,a=20){const s="https://api.spotify.com/v1/me/top/".concat(e);return(await C.a.get(s,{headers:{Authorization:"Bearer ".concat(this.token)},params:{time_range:t,limit:a}})).data.items}async searchForPlaylist(e,t){return(await C.a.get("https://api.spotify.com/v1/search",{headers:{Authorization:"Bearer ".concat(this.token)},params:{q:e.join("%20"),type:"playlist",limit:"10"}})).data.playlists.items.filter(a=>{let s=!0;return e.forEach(e=>{s=s&&a.name.toLowerCase().includes(e.toLowerCase())}),s&&a.owner.display_name.toLowerCase().includes(t.toLowerCase())})}async getPlaylist(e){let t=await C.a.get("".concat("https://api.spotify.com/v1/playlists/").concat(e),{headers:{Authorization:"Bearer ".concat(this.token)},params:{fields:"name,tracks.items(track)"}});return{name:t.data.name,tracks:t.data.tracks.items}}async getRecentTracks(){return(await C.a.get("https://api.spotify.com/v1/me/player/recently-played",{headers:{Authorization:"Bearer ".concat(this.token)},params:{limit:50}})).data.items}async getTrackFeatures(e,t){let a=[];e.forEach(e=>{e.track?a.push(e.track.id):a.push(e.id)});let s=await C.a.get("https://api.spotify.com/v1/audio-features",{headers:{Authorization:"Bearer ".concat(this.token)},params:{ids:a.join()}}),r=[];return s.data.audio_features.forEach(a=>{if(!a)return null;let s={};t.forEach(t=>{if("popularity"===t){const r=e.find(e=>(e.track?e.track.id:e.id)===a.id);s[t]=r.track?r.track.popularity:r.popularity}else a&&Object.keys(a).includes(t)&&(s[t]=a[t])}),r.push(s)}),r}},S=a(11);class x extends r.a.Component{constructor(e){super(e),this.state={token:this.props.token,data:[],features:[],isLoading:!0}}async componentDidMount(){const e=new T(this.props.token),t=["id","acousticness","danceability","energy","valence"],a=await e.searchForPlaylist(["Your Top Songs"],"Spotify");await Promise.all(a.map(async a=>{if(19===a.name.length){let s=await e.getPlaylist(a.id);const r=s.name.split(" ").pop(),n={year:r,tracks:s.tracks};this.setState({data:[...this.state.data,n]});const i=await e.getTrackFeatures(n.tracks,t);this.computeFeatures(r,i)}}));let s=await e.getUserFavorites("tracks","medium_term",50);s=s.map(e=>({track:e}));const r=await e.getTrackFeatures(s,t);this.computeFeatures("2020",r),this.createGraphData()}computeFeatures(e,t){let a={acousticness:0,danceability:0,energy:0,valence:0};t.forEach(e=>{for(let t in e)"id"!==t&&(a[t]+=e[t])});for(let s in a)a[s]=Math.round(100*(100*a[s]/t.length+Number.EPSILON))/100;this.setState({features:[...this.state.features,{year:e,averages:a}]})}createGraphData(){let e={acousticness:[],danceability:[],energy:[],valence:[]};[].concat(this.state.features).sort((e,t)=>e.year.localeCompare(t.year)).forEach(t=>{for(let a in t.averages)e[a].push(t.averages[a])});for(let r in e)for(;e[r].length<5;)e[r].unshift(null);let t={};const a={acousticness:[15.88,16.63,19.57,22.16,21.39,35.3,24,27.1],danceability:[63.25,69.68,71.65,71.38,71.99,71.3,69,67],energy:[67.24,66.07,65.91,64.06,65.05,62.7,67,64.3],valence:[45.15,51.7,48.44,54.6,53.1,69,49,51.4]},s={acousticness:[28.03,28.99,27.19,28.93,24.74],danceability:[60,61.23,66.5,64.42,67.31],energy:[59.29,58.67,59.06,57.88,61.19],valence:[43.08,41.45,44.71,46.59,48.28]};for(const r in e)t[r]={labels:["2016","2017","2018","2019","2020","2021","2022","2023"],datasets:[{data:e[r],label:"Your Top Songs",fill:!0,borderColor:"rgba(29,185,84,1)",backgroundColor:"rgba(29,185,84,0.4)",spanGaps:!1},{data:s[r],label:"Average Song",fill:!1,borderColor:"rgba(255, 255, 255, 0.9)"},{data:a[r],label:"Top Spotify Songs",fill:!1,borderColor:"rgba(255,99,132,1)"}]};this.setState({formattedData:t,isLoading:!1}),this.props.load()}render(){const e="Valence (positivity) describes how happy, cheerful, and euphoric a track feels, while tracks with low valence tend to sound sad, depressed, or angry.",t="Describes how suitable a track is for dancing based on a combination of its tempo, rhythm stability, and beat strength.",a="Describes how fast, loud, and noisy a track feels. For example, death metal has high energy, while a Bach prelude scores low on the scale.",s="Describes how many more elements of a song are acoustic, as opposed to electric. Songs with a higher score are more likely to be acoustic..";return!this.state.isLoading&&r.a.createElement("div",null,r.a.createElement(d.a,{fluid:"lg"},r.a.createElement(y.a,null,r.a.createElement("header",null,"Your Vibe"),r.a.createElement(S.a,{className:"mt-4 mb-4"},r.a.createElement(h.a,{md:6,className:"mt-4 mb-4"},r.a.createElement(k,{title:"Valence (Happiness)",description:e,data:this.state.formattedData.valence})),r.a.createElement(h.a,{md:6,className:"mt-4 mb-4"},r.a.createElement(k,{title:"Danceability",description:t,data:this.state.formattedData.danceability}))),r.a.createElement(S.a,{className:"mb-4"},r.a.createElement(h.a,{md:6,className:"mt-4 mb-4"},r.a.createElement(k,{title:"Energy",description:a,data:this.state.formattedData.energy})),r.a.createElement(h.a,{md:6,className:"mt-4 mb-4"},r.a.createElement(k,{title:"Acousticness",description:s,data:this.state.formattedData.acousticness}))),r.a.createElement("hr",null))))}}var L=x,N=a(33),I=a(66);a(117),a(118);class P extends s.Component{constructor(e){super(e),this.state={score:0}}render(){const e=[0,30,50,70,90,100],t=["Hipster","Eccentric","Trendy","Mainstream","Basic"],a=["\ud83e\uddd0","\ud83e\udd14","\ud83d\ude0e","\ud83e\udd29","\ud83d\udc81\u200d\u2640\ufe0f"];let s,n;for(let r=0;r<e.length-1;r++){const i=e[r],o=e[r+1];if(this.props.score>=i&&this.props.score<o){s=t[r],n=a[r];break}}return setTimeout(()=>{this.setState({score:Math.round(this.props.score)})},500),r.a.createElement(h.a,{className:"flex-column justify-content-center popularity-display"},r.a.createElement("h3",null,"".concat(s," ").concat(n)),r.a.createElement("h4",null,"Popularity Score"),r.a.createElement(S.a,{className:"justify-content-center",style:{height:"75%"}},r.a.createElement(I.a,{value:this.state.score,text:this.state.score,background:!0,backgroundPadding:5})))}}var _=P;E.a.defaults.global.defaultFontColor="white";class D extends r.a.Component{constructor(e){super(e),this.chartRef=r.a.createRef()}componentDidMount(){const{data:e}=this.props;let t={labels:[],data:[]};for(let s=0;s<e.length&&s<10;s++)t.labels.push(e[s].key),t.data.push(e[s].value);if(e.length>=10){let a=0;for(let t=10;t<e.length;t++)a+=e[t].value;t.labels.push("Other"),t.data.push(a)}const a=t.data.reduce((e,t)=>e+t,0);t.data=t.data.map(e=>Math.round(e/a*100)),new E.a(this.chartRef.current,{type:"doughnut",data:{labels:t.labels,datasets:[{label:"Genres",backgroundColor:["rgba(255, 221, 0, 0.8)","rgba(255, 200, 0, 0.8)","rgba(255,166,0, 0.8)","rgba(255,124,67, 0.8)","rgba(249,93,106, 0.8)","rgba(212,80,135, 0.8)","rgba(160,81,149, 0.8)","rgba(102,81,145, 0.8)","rgba(47,75,124, 0.8)","rgba(29, 52, 130, 0.8)","rgba(10, 36, 66, 0.8)"],borderColor:["rgba(255, 221, 0, 1)","rgba(255, 200, 0, 1)","rgba(255,166,0, 1)","rgba(255,124,67, 1)","rgba(249,93,106, 1)","rgba(212,80,135, 1)","rgba(160,81,149, 1)","rgba(102,81,145, 1)","rgba(47,75,124, 1)","rgba(29, 52, 130, 1)","rgba(10, 36, 66, 1)"],data:t.data}]},options:{legend:{position:"bottom"},responsive:!0,maintainAspectRatio:!1,tooltips:{callbacks:{label:function(e,t){return t.labels[e.index]+": "+t.datasets[0].data[e.index]+"%"}}}}})}render(){return r.a.createElement("div",{className:"doughnut-chart-container"},r.a.createElement("canvas",{ref:this.chartRef}))}}var F=D,R=a(29),M=a(30);class j extends s.Component{render(){let e,t,{percent:a,descriptions:s,emojis:n}=this.props,i="";if(a<0?(e=r.a.createElement(R.a,{icon:M.a,size:"lg",color:"red",style:{marginRight:"0.5em"}}),i=s[0]):0===a?i=s[1]:(e=r.a.createElement(R.a,{icon:M.b,size:"lg",color:"rgba(73, 209, 0, 1)",style:{marginRight:"0.5em"}}),i=s[2]),a>100)t=n[n.length-1];else if(a<-100)t=n[0];else{const e=200/n.length;t=n[Math.floor((a+100)/e)]}return r.a.createElement("div",null,r.a.createElement("span",{className:"emoji"}," ",t," "),r.a.createElement(S.a,{className:"d-flex flex-direction-column justify-content-center align-items-center"},e,r.a.createElement("h2",null,Math.abs(a),"%")),r.a.createElement("h5",null,i))}}var A=j,H=a(31);class B extends s.Component{averageFeatures(e){let t={};e.forEach(e=>{for(let a in e)"id"!==a&&(t[a]?t[a]+=e[a]:t[a]=e[a])});for(let a in t)t[a]=t[a]/e.length;return t}calculatePercentDifferences(e,t){let a={};for(const s in e){const r=Math.round((t[s]-e[s])/e[s]*100);a[s]=r}return a}render(){const e=this.averageFeatures(this.props.recentTracksFeatures),t=this.averageFeatures(this.props.comparisonTracksFeatures[this.props.comparisonType]),a=this.calculatePercentDifferences(t,e),{valence:s,danceability:n,energy:i,acousticness:o}=a;return r.a.createElement(y.a,{bottom:!0},r.a.createElement("hr",null),r.a.createElement(H.a,{className:"mb-2"},r.a.createElement(c.a,{variant:"outline-success",className:"top"===this.props.comparisonType&&"active",type:"radio",name:"comparisonType",value:"top",onClick:e=>this.props.handleChange(e),checked:"top"===this.props.time_range,defaultChecked:!0},"Today's Top Hits"),r.a.createElement(c.a,{variant:"outline-success",className:"short_term"===this.props.comparisonType&&"active",type:"radio",name:"comparisonType",value:"short_term",onClick:e=>this.props.handleChange(e),checked:"short_term"===this.props.comparisonType},"Last Month"),r.a.createElement(c.a,{variant:"outline-success",className:"medium_term"===this.props.comparisonType&&"active",type:"radio",name:"comparisonType",value:"medium_term",onClick:e=>this.props.handleChange(e),checked:"medium_term"===this.props.comparisonType},"Last 6 Months"),r.a.createElement(c.a,{variant:"outline-success",className:"long_term"===this.props.comparisonType&&"active",type:"radio",name:"comparisonType",value:"long_term",onClick:e=>this.props.handleChange(e),checked:"long_term"===this.props.comparisonType},"All Time")),r.a.createElement(S.a,null,r.a.createElement(h.a,{md:3},r.a.createElement(A,{percent:s,descriptions:["Less happy","Same happiness","Happier"],emojis:["\ud83d\ude2d","\ud83d\ude22","\ud83d\ude15","\ud83d\ude03","\ud83d\ude01","\ud83d\ude0a"]})),r.a.createElement(h.a,{md:3},r.a.createElement(A,{percent:n,descriptions:["Less danceable","Same danceability","More danceable"],emojis:["\ud83d\udc83"]})),r.a.createElement(h.a,{md:3},r.a.createElement(A,{percent:i,descriptions:["Less energetic","Same energy","More energetic"],emojis:["\ud83d\ude34","\u26a1\ufe0f","\ud83d\udd25"]})),r.a.createElement(h.a,{md:3},r.a.createElement(A,{percent:o,descriptions:["Less acoustic","Same acousticness","More acoustic"],emojis:["\ud83c\udfb8","\ud83c\udfbb"]})),r.a.createElement("hr",null)))}}var z=a(146),U=a(82),G=a(145),W=a(81),O=a(67);a(121);class V extends s.Component{render(){const{value:e,title:t,color:a,tooltip:s}=this.props,n=Object(U.a)({overrides:{MuiSlider:{valueLabel:{paddingLeft:"4px"},thumb:{width:"15px",height:"15px"},track:{height:"5px"},rail:{height:"5px",color:"#b1b1b1"}}}});return r.a.createElement("div",null,r.a.createElement("span",{className:"slider-title"},r.a.createElement(W.a,{placement:"right",overlay:e=>r.a.createElement(O.a,e,s)},r.a.createElement("span",{className:"slider-name"},t)),r.a.createElement("span",{className:"slider-value"},e)),r.a.createElement(G.a,{theme:n},r.a.createElement(z.a,{className:"slider--".concat(a),value:e,valueLabelDisplay:"auto"})))}}var Y=V;class q extends s.Component{render(){const{track:e}=this.props,t=["yellow","orange","red","purple","blue","light-blue","aqua","green"],a=["Based on the total number of plays the track has had and how recent those plays are","Describes the musical positiveness conveyed by a track","Describes how suitable a track is for dancing based on tempo, rhythm, beat, etc.","Represents a perceptual measure of intensity and activity","A confidence measure from 0.0 to 1.0 of whether the track is acoustic","Detects the presence of an audience in the recording","Speechiness detects the presence of spoken words in a track","Predicts whether a track contains no vocals"],s=[];let n=0;for(const i in e.features){let o=e.features[i];"popularity"!==i&&(o=Math.round(100*o));let l=i.charAt(0).toUpperCase()+i.slice(1);"Valence"===l&&(l="Happiness"),s.push(r.a.createElement(Y,{key:"".concat(i,"-slider"),title:l,value:o,color:t[n%t.length],tooltip:a[n]})),n++}return r.a.createElement(h.a,{className:"d-flex flex-column h-100 justify-content-between p-0"},s)}}var J=q,K=a(83),Q=a(49);function X(e){const t=e.images.map(e=>r.a.createElement(Q.a.Item,{key:e.key},r.a.createElement("img",{src:e.url,alt:"album cover"})));return r.a.createElement(Q.a,{indicators:!1,controls:!1,fade:!1,interval:e.pause?null:5e3,onSelect:t=>e.handleSlide(t),activeIndex:e.activeIndex},t)}a(63),a(64);class Z extends s.Component{constructor(e){super(e),this.state={trackIsPlaying:!1}}handlePlayPause(e){"play"===e.type?this.setState({trackIsPlaying:!0}):"pause"===e.type&&this.setState({trackIsPlaying:!1})}handleEnded(e){this.props.nextSlide(e),this.setState({trackIsPlaying:!0})}render(){return r.a.createElement("div",null,r.a.createElement(X,{images:this.props.trackImages,handleSlide:this.props.handleSlide,pause:this.state.trackIsPlaying,activeIndex:this.props.currentIndex}),r.a.createElement(K.a,{autoPlay:this.state.trackIsPlaying,src:this.props.currentTrack.previewURL,onPlay:e=>this.handlePlayPause(e),onPause:e=>this.handlePlayPause(e),onClickPrevious:e=>this.props.previousSlide(e),onClickNext:e=>this.props.nextSlide(e),onEnded:e=>this.handleEnded(e),showFilledProgress:!1,showDownloadProgress:!1,showSkipControls:!0,showJumpControls:!1,customProgressBarSection:[],volume:.3,autoPlayAfterSrcChange:this.state.trackIsPlaying}))}}var $=Z;class ee extends s.Component{constructor(e){super(e),this.state={currentTrack:this.props.tracks[0],currentIndex:0},this.handleSlide=this.handleSlide.bind(this),this.nextSlide=this.nextSlide.bind(this),this.previousSlide=this.previousSlide.bind(this)}handleSlide(e){this.setState({currentIndex:e,currentTrack:this.props.tracks[e]})}nextSlide(){const e=(this.state.currentIndex+1)%this.props.tracks.length;this.setState({currentIndex:e,currentTrack:this.props.tracks[e]})}previousSlide(){const e=0===this.state.currentIndex?this.props.tracks.length-1:this.state.currentIndex-1;this.setState({currentIndex:e,currentTrack:this.props.tracks[e]})}render(){const e=this.props.tracks.map(e=>({key:e.id,url:e.image}));return r.a.createElement("div",null,r.a.createElement("div",{style:{minHeight:"5em"}},r.a.createElement("h4",null,this.state.currentTrack.name),r.a.createElement("h6",null,this.state.currentTrack.artist)),r.a.createElement(S.a,{className:"d-flex justify-content-center mt-2"},r.a.createElement(h.a,{md:{span:6,order:2},className:"d-flex flex-column justify-content-center h-100"},r.a.createElement($,{trackImages:e,handleSlide:this.handleSlide,currentTrack:this.state.currentTrack,currentIndex:this.state.currentIndex,nextSlide:this.nextSlide,previousSlide:this.previousSlide})),r.a.createElement(h.a,{md:{span:6,order:1}},r.a.createElement(J,{track:this.state.currentTrack}))))}}var te=ee;class ae extends s.Component{constructor(e){super(e),this.state={isLoading:!0,comparisonType:"top",comparisonTracksFeatures:{},recentTracksFeatures:[],popularity:0,trackImages:[],uniqueRecentTracks:[],showComparison:!0},this.cycleComparisonTypes.bind(this)}async getGenres(e){let t=[];e.forEach(e=>{t.push(e.track.artists[0].id)});let a=await C.a.get("https://api.spotify.com/v1/artists",{headers:{Authorization:"Bearer ".concat(this.props.token)},params:{ids:t.join()}}),s=new Map;a.data.artists.forEach(e=>{const t=e.genres[0];t&&s.get(t)?s.set(t,s.get(t)+1):s.set(t,1)});let r=[];return s.forEach((e,t)=>{r.push({key:t,value:e})}),r.sort((e,t)=>t.value-e.value),r}async getComparisonFeatures(e){const t=new T(this.props.token),a=["acousticness","danceability","energy","valence","popularity"];if("top"===e){const e=(await t.searchForPlaylist(["Today's top hits"],"Spotify"))[0].id,s=await t.getPlaylist(e);return await t.getTrackFeatures(s.tracks,a)}{const s=await t.getUserFavorites("tracks",e,50);return await t.getTrackFeatures(s,a)}}async cycleComparisonTypes(){const e=["top","short_term","medium_term","long_term"];setInterval(async()=>{const t=e.indexOf(this.state.comparisonType)+1;this.setState({showComparison:!1});const a=e[t%e.length];setTimeout(()=>{this.setState({showComparison:!0,comparisonType:a})},500)},1e4)}async componentDidMount(){try{const e=new T(this.props.token);let t=["acousticness","danceability","energy","instrumentalness","liveness","speechiness","valence","popularity"];const a=await e.getRecentTracks(),s=await e.getTrackFeatures(a,t);let r=[];for(let c=0;c<a.length;c++){let e={};const t=a[c].track;if(!s[c])continue;const{popularity:n,valence:i,danceability:o,energy:l,acousticness:p,liveness:m,speechiness:h,instrumentalness:d}=s[c];e={id:t.id,name:t.name,artist:t.artists[0].name,image:t.album.images[0].url,previewURL:t.preview_url,features:{popularity:n,valence:i,danceability:o,energy:l,acousticness:p,liveness:m,speechiness:h,instrumentalness:d}},r.push(e)}const n=Array.from(new Set(r.map(e=>e.id))).map(e=>r.find(t=>t.id===e)),i=await this.getGenres(a);let o=0;s.forEach(e=>{o+=e.popularity}),o/=s.length;let l={top:[],short_term:[],medium_term:[],long_term:[]};for(const c in l)l[c]=await this.getComparisonFeatures(c);this.setState({uniqueRecentTracks:n,recentTracksFeatures:s,comparisonTracksFeatures:l,popularity:o,genres:i,isLoading:!1}),this.props.load(),this.cycleComparisonTypes()}catch(e){console.log(e),e.response&&401===e.response.status&&this.props.handleTimeout()}}componentWillUnmount(){clearInterval(this.interval)}handleChange(e){const{name:t,value:a,type:s,checked:r}=e.target;"checkbox"===s?this.setState({[t]:r}):this.setState({[t]:a})}render(){let e="";switch(this.state.comparisonType){case"top":e="today's top hits";break;case"short_term":e="your last month";break;case"medium_term":e="your last 6 months";break;case"long_term":e="your all-time favorites"}return this.state.isLoading?null:r.a.createElement("div",null,r.a.createElement(y.a,null,r.a.createElement(h.a,{className:"mood-top-section d-flex flex-column"},r.a.createElement("header",null,"Your Mood"),r.a.createElement(_,{score:this.state.popularity}),r.a.createElement("h4",null,"How do your recent songs compare to"," ",r.a.createElement(N.a,{in:this.state.showComparison,timeout:500},r.a.createElement("span",{style:{color:"#1DB954",fontSize:"xx-large"}},e)),"?"),r.a.createElement(B,{percentages:this.state.percentages,recentTracksFeatures:this.state.recentTracksFeatures,comparisonTracksFeatures:this.state.comparisonTracksFeatures,comparisonType:this.state.comparisonType,showComparison:this.state.showComparison,handleChange:e=>this.handleChange(e)})),r.a.createElement(d.a,{fluid:!0,className:"mb-4 mt-2"},r.a.createElement(te,{tracks:this.state.uniqueRecentTracks})),r.a.createElement("hr",null),r.a.createElement(d.a,{fluid:!0,className:" d-flex flex-column",style:{minHeight:"90vh"}},r.a.createElement(S.a,null,r.a.createElement(h.a,{className:"justify-content-center"},r.a.createElement("h2",null,"Your Recent Genres"),r.a.createElement(F,{data:this.state.genres}))))),r.a.createElement("hr",null))}}var se=ae,re=a(80),ne=a.n(re);function ie(){return r.a.createElement("div",{style:{height:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}},r.a.createElement(y.a,null,r.a.createElement("img",{src:ne.a,style:{maxHeight:"40vh",maxWidth:"80vw"},alt:"Cassette spinning loading animation"}),r.a.createElement("h1",null,"Loading your vibe...")))}a(125);class oe extends r.a.Component{constructor(e){super(e),this.state={isPlaying:!1,isHovering:!1},this.handleMouseHover=this.handleMouseHover.bind(this)}handleClick(){this.props.playTrack(this.props.previewURL)}handleMouseHover(){this.setState(this.toggleHoverState)}toggleHoverState(e){return{isHovering:!e.isHovering}}render(){const{type:e,position:t,title:a,subtitle:s,searchTerm:n,image:i,isPlaying:o}=this.props,l=-1===a.toLowerCase().indexOf(n.toLowerCase()),c=-1===s.toLowerCase().indexOf(n.toLowerCase());if(l&&c)return null;const p=i?{backgroundImage:"url(".concat(i,")")}:{backgroundColor:"black"};let m=r.a.createElement(y.a,null,r.a.createElement("div",{className:"result-item"},r.a.createElement("span",{className:"order-number"},t),r.a.createElement("span",{className:"result-info"},r.a.createElement("span",{className:"result-cover",style:p}),r.a.createElement("span",{className:"result-summary"},r.a.createElement("span",{className:"result-artist"},s),r.a.createElement("span",{className:"result-name"},a))),r.a.createElement("div",{style:{marginLeft:"auto"}},o?r.a.createElement(u,null):this.state.isHovering&&r.a.createElement(R.a,{size:"3x",icon:M.c}))));return m="track"===e?this.props.previewURL?r.a.createElement("div",{onMouseEnter:this.handleMouseHover,onMouseLeave:this.handleMouseHover,onClick:()=>this.handleClick()},m):r.a.createElement("a",{onMouseEnter:this.handleMouseHover,onMouseLeave:this.handleMouseHover,href:this.props.uri,target:"_blank",rel:"noopener noreferrer"},m):r.a.createElement("a",{href:this.props.uri,rel:"noopener noreferrer",target:"_blank"},m),m}}var le=oe;class ce extends r.a.Component{constructor(e){super(e),this.state={currentlyPlaying:""},this.playTrack=this.playTrack.bind(this)}playTrack(e){let t=document.getElementById("favorite-player");t?(t.paused?(t.play(),this.setState({currentlyPlaying:e})):(t.pause(),this.setState({currentlyPlaying:""})),t.src!==e&&(t.currentTime=0,t.src=e,t.play(),this.setState({currentlyPlaying:e}))):(t=new Audio(e),t.setAttribute("id","favorite-player"),t.onended=()=>this.setState({currentlyPlaying:""}),t.volume=.3,document.getElementById("result-table").append(t),t.play(),this.setState({currentlyPlaying:e}))}render(){let e;return e="tracks"===this.props.topType?this.props.data.map((e,t)=>r.a.createElement(le,{type:"track",position:t+1,key:e.id,title:e.name,subtitle:e.artists[0].name,image:void 0===e.album.images[0]?null:e.album.images[0].url,previewURL:e.preview_url,uri:e.external_urls.spotify,searchTerm:this.props.searchTerm,playTrack:this.playTrack,isPlaying:this.state.currentlyPlaying===e.preview_url})):this.props.data.map((e,t)=>r.a.createElement(le,{type:"artist",position:t+1,key:e.id,title:e.name,uri:e.external_urls.spotify,subtitle:e.genres.join(", "),image:void 0===e.images[0]?null:e.images[0].url,searchTerm:this.props.searchTerm})),r.a.createElement("div",{id:"result-table"},e||r.a.createElement("h3",{className:"no-results",style:{alignSelf:"center"}},"No Results"))}}var pe=ce;class me extends r.a.Component{render(){return this.props.isLoggedIn?null:r.a.createElement("div",null,r.a.createElement(S.a,{className:"d-flex justify-content-between p-4"},r.a.createElement(h.a,{md:4,className:"mb-4"},r.a.createElement("input",{className:"search-field",name:"searchTerm",value:this.props.searchTerm,type:"text",placeholder:"Search",onChange:e=>this.props.handleChange(e)})),r.a.createElement(h.a,{md:4,className:"mb-4"},r.a.createElement(H.a,null,r.a.createElement(c.a,{variant:"outline-success",className:"short_term"===this.props.timeRange&&"active",type:"radio",name:"timeRange",value:"short_term",onClick:e=>this.props.handleChange(e),checked:"short_term"===this.props.time_range,defaultChecked:!0},"Last Month"),r.a.createElement(c.a,{variant:"outline-success",className:"medium_term"===this.props.timeRange&&"active",type:"radio",name:"timeRange",value:"medium_term",onClick:e=>this.props.handleChange(e),checked:"medium_term"===this.props.timeRange},"Last 6 Months"),r.a.createElement(c.a,{variant:"outline-success",className:"long_term"===this.props.timeRange&&"active",type:"radio",name:"timeRange",value:"long_term",onClick:e=>this.props.handleChange(e),checked:"long_term"===this.props.timeRange},"All Time"))),r.a.createElement(h.a,{md:4,className:"mb-4"},r.a.createElement(H.a,null,r.a.createElement(c.a,{variant:"outline-success",className:"tracks"===this.props.topType&&"active",type:"radio",name:"topType",value:"tracks",onClick:e=>this.props.handleChange(e),checked:"tracks"===this.props.topType,defaultChecked:!0},"Tracks"),r.a.createElement(c.a,{variant:"outline-success",className:"artists"===this.props.topType&&"active",type:"radio",name:"topType",value:"artists",onClick:e=>this.props.handleChange(e),checked:"artists"===this.props.topType},"Artists")))),"tracks"===this.props.topType&&r.a.createElement(S.a,{className:"justify-content-center pb-4"},r.a.createElement(c.a,{variant:"success",className:"create-button",onClick:e=>this.props.handleCreatePlaylist()},"Create Playlist",r.a.createElement("span",{style:{fontWeight:"600",fontSize:"25px"}}," ","+"))))}}var he=me;class de extends r.a.Component{constructor(e){super(e),this.handleChange=async e=>{const{name:t,value:a,type:s,checked:r}=e.target;"topType"===t&&this.setState({data:[]}),"checkbox"===await s?this.setState({[t]:r}):this.setState({[t]:a});const n=new T(this.props.token),i=await n.getUserFavorites(this.state.topType,this.state.timeRange,50);this.setState({data:i,isLoading:!1})},this.handleCreatePlaylist=async()=>{const e=new T(this.props.token),t=await e.getUserID();let a;switch(this.state.timeRange){case"short_term":a="Last Month";break;case"medium_term":a="Last 6 Months";break;case"long_term":a="All Time"}let s="My Top 50 Songs \u2022 "+a;const r="Created on "+(new Date).toDateString()+", courtesy of Spotivibe \u2764\ufe0f",n=await e.createPlaylist(t,s,r,!1),i=this.state.data.map(e=>e.uri);await e.addItemsToPlaylist(n,i);const o="spotify:user:".concat(t,":playlist:").concat(n);window.open(o,"_blank","")},this.state={isLoading:!0,data:[],timeRange:"short_term",searchTerm:"",topType:"tracks"}}async componentDidMount(){const e=new T(this.props.token),t=await e.getUserFavorites(this.state.topType,this.state.timeRange,50);this.setState({data:t,isLoading:!1}),this.props.load()}render(){return this.state.isLoading?null:r.a.createElement("div",null,r.a.createElement(y.a,null,r.a.createElement("header",null,"Your Favorites"),r.a.createElement(he,{handleChange:this.handleChange,handleCreatePlaylist:this.handleCreatePlaylist,timeRange:this.state.timeRange,topType:this.state.topType})),r.a.createElement(pe,{topType:this.state.topType,data:this.state.data,searchTerm:this.state.searchTerm}))}}var ue=de;function ge(){return r.a.createElement("footer",{className:"mt-2 mb-4"},r.a.createElement(y.a,null,r.a.createElement("h6",null,"Like what you see?"),r.a.createElement("h6",null,"Give this project a"," ",r.a.createElement("span",{role:"img","aria-label":"star emoji"},"\ud83c\udf1f")," ","on",r.a.createElement("a",{href:"https://github.com/Nicholas-Lin/vibe",target:"_blank",rel:"noopener noreferrer"}," ","Github.")),r.a.createElement("h6",null,"Share it with your friends"," ",r.a.createElement("span",{role:"img","aria-label":"star emoji"},"\ud83d\ude0e"))))}class ye extends r.a.Component{constructor(e){super(e),this.state={isLoading:!0,moodDashboardIsLoading:!0,vibeDashboardIsLoading:!0,favoritesDisplayIsLoading:!0}}updateLoadingStatus(){this.state.moodDashboardIsLoading||this.state.vibeDashboardIsLoading||this.state.favoritesDisplayIsLoading||this.setState({isLoading:!1})}loadMoodDashboard(){this.setState({moodDashboardIsLoading:!1}),this.updateLoadingStatus()}loadVibeDashboard(){this.setState({vibeDashboardIsLoading:!1}),this.updateLoadingStatus()}loadFavorites(){this.setState({favoritesDisplayIsLoading:!1}),this.updateLoadingStatus()}render(){return r.a.createElement(r.a.Fragment,null,this.state.isLoading&&r.a.createElement(ie,null),r.a.createElement(d.a,{fluid:"lg"},r.a.createElement(se,{token:this.props.token,load:()=>this.loadMoodDashboard(),handleTimeout:()=>this.props.handleTimeout()}),r.a.createElement(L,{token:this.props.token,load:()=>this.loadVibeDashboard()}),r.a.createElement(ue,{token:this.props.token,load:()=>this.loadFavorites()}),r.a.createElement(ge,null)))}}var be=ye;class fe extends r.a.Component{constructor(e){super(e),this.state={isLoggedIn:!1,token:null}}componentDidMount(){let e=o.access_token;e&&this.setState({token:e})}handleLogin(){window.location.replace(l),this.setState({isLoggedIn:!0})}render(){return r.a.createElement("div",{className:"App"},!this.state.token&&r.a.createElement(b,{isLoggedIn:this.state.isLoggedIn,handleLogin:()=>this.handleLogin()}),this.state.token&&r.a.createElement(be,{token:this.state.token,handleTimeout:()=>this.handleLogin()}))}}var Ee=fe;i.a.render(r.a.createElement(Ee,null),document.getElementById("root"))},64:function(e,t,a){},80:function(e,t,a){e.exports=a.p+"static/media/cassette.f720df37.gif"},84:function(e,t,a){e.exports=a(126)},90:function(e,t,a){},91:function(e,t,a){},92:function(e,t,a){}},[[84,1,2]]]);
//# sourceMappingURL=main.aa1b0027.chunk.js.map